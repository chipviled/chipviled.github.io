"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function template_iteration(t){return Handlebars.compile('\n    <div class="iteration gallery" data-id="{{id}}">\n      <div class="iteration_title">\n       <div class="iteration_name">{{theme}}</div>\n       <div class="iteration_date">{{date_begin}} - {{date_end}}</div>\n      </div>\n      <div class="iteration_body" itemscope itemtype="http://schema.org/ImageGallery">\n      \n        {{#each pictures}}\n            <figure class="picture \n                    {{#is_win_null}}picture_win{{/is_win_null}} \n                    {{#if is_voted}}{{else}}picture__not-voted{{/if}} \n                    "\n                    itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">\n                <a href="./data/upload/{{file_path}}/{{file_name}}" \n                        class="picture_body "\n                        itemprop="contentUrl" \n                        data-size="{{pict_width}}x{{pict_height}}">\n                    <img src="./data/upload/{{file_path}}/thumb_{{file_name}}" \n                            itemprop="thumbnail" alt="pict" />\n                </a>\n                \n                <figcaption itemprop="caption description">\n                <div class="picture_title">{{title}}</div>\n                <div class="picture_username">\n                    <a href="//sonic-world.ru/forum/user/{{user_sity_id}}-{{user_name}}">{{user_name}}</a>\n                </div>\n                </figcaption>\n            </figure>\n        {{/each}}\n        \n      </div>\n    </div>\n    ')(t)}function work(t){var e=document.getElementById("iterations"),n=alasql("\n        SELECT i.*\n        FROM ? i\n        ORDER BY i.date_begin DESC\n        ",[t.iteration]);e.innerHTML="";var i=!0,o=!1,a=void 0;try{for(var r,s=n[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value,p=alasql("\n            SELECT p.*, \n              u.name AS user_name, \n              u.sity_id AS user_sity_id,\n              IF(p.is_win > 0, true, NULL) AS is_win_null\n            FROM ? p\n            LEFT JOIN ? u ON u.id = p.user_id\n            WHERE p.iteration_id = ?\n            ORDER BY p.id\n            ",[t.picture,t.users,l.id]);l.pictures=p;var d=document.createElement("li");d.innerHTML=template_iteration(l),e.appendChild(d)}}catch(t){o=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();void 0===console.log&&(console.log=function(){}),console.log("%c                               \n   Are you like web console?   \n                               ","color:#FFFFFF;background-color:#993399;");var photoswipe_init=function(){function t(e){_classCallCheck(this,t);var n=document.createElement("div");n.innerHTML=this.template_photoswipe(),document.body.appendChild(n),this.initPhotoSwipeFromDOM(e)}return _createClass(t,[{key:"template_photoswipe",value:function(){return'\n        <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">\n            <div class="pswp__bg"></div>\n            <div class="pswp__scroll-wrap">\n                <div class="pswp__container">\n                    <div class="pswp__item"></div>\n                    <div class="pswp__item"></div>\n                    <div class="pswp__item"></div>\n                </div>\n                <div class="pswp__ui pswp__ui--hidden">\n                    <div class="pswp__top-bar">\n                        <div class="pswp__counter"></div>\n                        <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>\n                        <button class="pswp__button pswp__button--share" title="Share"></button>\n                        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>\n                        <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>\n                        <div class="pswp__preloader">\n                            <div class="pswp__preloader__icn">\n                              <div class="pswp__preloader__cut">\n                                <div class="pswp__preloader__donut"></div>\n                              </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">\n                        <div class="pswp__share-tooltip"></div> \n                    </div>\n                    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">\n                    </button>\n                    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">\n                    </button>\n                    <div class="pswp__caption">\n                        <div class="pswp__caption__center"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    '}},{key:"initPhotoSwipeFromDOM",value:function(t){for(var e=function(t){for(var e,n,i,o,a=t.childNodes,r=a.length,s=[],l=0;l<r;l++)if(1===(e=a[l]).nodeType){n=e.children[0];try{i=n.getAttribute("data-size").split("x")}catch(t){i=[10,10]}o={src:n.getAttribute("href"),w:parseInt(i[0],10),h:parseInt(i[1],10)},e.children.length>1&&(o.title=e.children[1].innerHTML),n.children.length>0&&(o.msrc=n.children[0].getAttribute("src")),o.el=e,s.push(o)}return s},n=function t(e,n){return e&&(n(e)?e:t(e.parentNode,n))},i=function(t,n,i,o){var a,r,s=document.querySelectorAll(".pswp")[0];if(r=e(n),a={galleryUID:n.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(t){var e=r[t].el.getElementsByTagName("img")[0],n=window.pageYOffset||document.documentElement.scrollTop,i=e.getBoundingClientRect();return{x:i.left,y:i.top+n,w:i.width}}},o)if(a.galleryPIDs){for(var l=0;l<r.length;l++)if(r[l].pid==t){a.index=l;break}}else a.index=parseInt(t,10)-1;else a.index=parseInt(t,10);isNaN(a.index)||(i&&(a.showAnimationDuration=0),new PhotoSwipe(s,PhotoSwipeUI_Default,r,a).init())},o=document.querySelectorAll(t),a=0,r=o.length;a<r;a++)o[a].setAttribute("data-pswp-uid",a+1),o[a].onclick=function(t){(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1;var e=t.target||t.srcElement,o=n(e,function(t){return t.tagName&&"FIGURE"===t.tagName.toUpperCase()});if(o){for(var a,r=o.parentNode,s=o.parentNode.childNodes,l=s.length,p=0,d=0;d<l;d++)if(1===s[d].nodeType){if(s[d]===o){a=p;break}p++}return a>=0&&i(a,r),!1}};var s=function(){var t=window.location.hash.substring(1),e={};if(t.length<5)return e;for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i]){var o=n[i].split("=");o.length<2||(e[o[0]]=o[1])}return e.gid&&(e.gid=parseInt(e.gid,10)),e}();s.pid&&s.gid&&i(s.pid,o[s.gid-1],!0,!0)}}]),t}();Promise.all([Vue.http.get("./data/json/picture.json?v="+config.v),Vue.http.get("./data/json/users.json?v="+config.v),Vue.http.get("./data/json/iteration.json?v="+config.v),Vue.http.get("./data/json/achivement.json?v="+config.v),Vue.http.get("./data/json/user_achivement.json?v="+config.v),Vue.http.get("./data/json/user_vote.json?v="+config.v)]).then(function(t){work({picture:t[0].body,users:t[1].body,iteration:t[2].body,achivement:t[3].body,user_achivement:t[4].body,user_vote:t[5].body}),new photoswipe_init(".gallery")},function(t){console.log("Error from load data.",t),document.getElementById("loader").innerHTML="Error from load data. :("});